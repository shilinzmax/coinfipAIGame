<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¸è¿æ•°å­—è°ƒè¯•</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        button { padding: 10px 15px; margin: 5px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .inactive { background-color: #f0f0f0; }
        .active { background-color: #e8f5e8; }
        .triggered { background-color: #fff3cd; }
    </style>
</head>
<body>
    <h1>ğŸ€ å¹¸è¿æ•°å­—åŠŸèƒ½è°ƒè¯•</h1>
    
    <div class="debug-section">
        <h3>å¹¸è¿æ•°å­—è®¾ç½®</h3>
        <label for="luckyNumber">é€‰æ‹©å¹¸è¿æ•°å­—:</label>
        <select id="luckyNumber">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
        </select>
        <button onclick="updateLuckyNumber()">æ›´æ–°å¹¸è¿æ•°å­—</button>
    </div>
    
    <div class="debug-section">
        <h3>æ¸¸æˆå†å²æ¨¡æ‹Ÿ</h3>
        <button onclick="addGame('æ­£é¢')">æ·»åŠ æ­£é¢ç»“æœ</button>
        <button onclick="addGame('åé¢')">æ·»åŠ åé¢ç»“æœ</button>
        <button onclick="clearHistory()">æ¸…ç©ºå†å²</button>
        <div id="gameHistory"></div>
    </div>
    
    <div class="debug-section">
        <h3>å¹¸è¿æ•°å­—çŠ¶æ€</h3>
        <div id="luckyStatus" class="status inactive">æœªè®¾ç½®</div>
        <button onclick="updateLuckyStatus()">åˆ·æ–°çŠ¶æ€</button>
    </div>
    
    <div class="debug-section">
        <h3>è°ƒè¯•ä¿¡æ¯</h3>
        <div id="debugInfo"></div>
    </div>

    <script>
        // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
        let user = {
            username: 'testuser',
            luckyNumber: 5,
            gameHistory: []
        };
        
        // DOMå…ƒç´ 
        const luckyNumberSelect = document.getElementById('luckyNumber');
        const luckyStatus = document.getElementById('luckyStatus');
        const gameHistoryDiv = document.getElementById('gameHistory');
        const debugInfo = document.getElementById('debugInfo');
        
        // æ›´æ–°å¹¸è¿æ•°å­—
        function updateLuckyNumber() {
            user.luckyNumber = parseInt(luckyNumberSelect.value);
            updateLuckyStatus();
            updateDebugInfo();
        }
        
        // æ·»åŠ æ¸¸æˆç»“æœ
        function addGame(result) {
            const game = {
                id: Date.now(),
                result: result,
                timestamp: new Date().toISOString(),
                playTime: new Date().toLocaleString('zh-CN')
            };
            user.gameHistory.unshift(game);
            updateGameHistoryDisplay();
            updateLuckyStatus();
            updateDebugInfo();
        }
        
        // æ¸…ç©ºå†å²
        function clearHistory() {
            user.gameHistory = [];
            updateGameHistoryDisplay();
            updateLuckyStatus();
            updateDebugInfo();
        }
        
        // æ›´æ–°æ¸¸æˆå†å²æ˜¾ç¤º
        function updateGameHistoryDisplay() {
            gameHistoryDiv.innerHTML = user.gameHistory.map((game, index) => 
                `<div>${index + 1}. ${game.result} (${game.playTime})</div>`
            ).join('');
        }
        
        // æ›´æ–°å¹¸è¿æ•°å­—çŠ¶æ€
        function updateLuckyStatus() {
            if (!user.luckyNumber) {
                luckyStatus.textContent = 'æœªè®¾ç½®';
                luckyStatus.className = 'status inactive';
                return;
            }
            
            const totalFlips = user.gameHistory.length + 1;
            const luckyNumber = user.luckyNumber;
            
            if (totalFlips === luckyNumber) {
                luckyStatus.textContent = 'ğŸ€ å³å°†æ¿€æ´»!';
                luckyStatus.className = 'status active';
            } else if (totalFlips > luckyNumber) {
                luckyStatus.textContent = 'å·²è¿‡æœŸ';
                luckyStatus.className = 'status inactive';
            } else {
                luckyStatus.textContent = `è¿˜éœ€ ${luckyNumber - totalFlips} æ¬¡`;
                luckyStatus.className = 'status inactive';
            }
        }
        
        // æ›´æ–°è°ƒè¯•ä¿¡æ¯
        function updateDebugInfo() {
            const totalFlips = user.gameHistory.length;
            const nextFlip = totalFlips + 1;
            const luckyNumber = user.luckyNumber;
            
            debugInfo.innerHTML = `
                <p><strong>å½“å‰å¹¸è¿æ•°å­—:</strong> ${luckyNumber}</p>
                <p><strong>å·²ç©æ¸¸æˆæ¬¡æ•°:</strong> ${totalFlips}</p>
                <p><strong>ä¸‹æ¬¡æ·ç¡¬å¸:</strong> ç¬¬${nextFlip}æ¬¡</p>
                <p><strong>æ˜¯å¦è§¦å‘å¹¸è¿æ•°å­—:</strong> ${nextFlip === luckyNumber ? 'æ˜¯' : 'å¦'}</p>
                <p><strong>æ¸¸æˆå†å²:</strong> ${user.gameHistory.map(g => g.result).join(', ') || 'æ— '}</p>
            `;
        }
        
        // åˆå§‹åŒ–
        function init() {
            luckyNumberSelect.value = user.luckyNumber;
            updateLuckyStatus();
            updateDebugInfo();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
